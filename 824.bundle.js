"use strict";(self.webpackChunkrspack_project=self.webpackChunkrspack_project||[]).push([["824"],{6755:function(e,t,r){r.r(t),r.d(t,{default:()=>f});var n=r(2800),i=r(2124);function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){var n;n=r[t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}return e}function o(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}let s=e=>{let{bg:t=[],movies:r=[]}=e,s=(0,i.useRef)(null),a=(0,i.useRef)(null),[u,c]=(0,i.useState)({isPlaying:!1,isLoading:!1,currentVideo:"",currentImage:""}),d=()=>{s.current&&s.current.play().then(()=>{c(e=>o(l({},e),{isPlaying:!0,isLoading:!1}))}).catch(e=>{console.error("Error playing video:",e)})},p=()=>{if(0===r.length)return;c(e=>o(l({},e),{isLoading:!0}));let e=(()=>{if(0===r.length)return"";let e=Math.floor(Math.random()*r.length);return r[e]})();c(t=>o(l({},t),{currentVideo:e})),s.current&&s.current.load()};return(0,i.useEffect)(()=>{let e=()=>{let e=window.innerHeight;a.current&&(a.current.style.height="".concat(e,"px"))};return e(),window.addEventListener("resize",e),r.length>0&&p(),()=>{window.removeEventListener("resize",e)}},[]),(0,n.jsxs)("div",{className:"video-container",ref:a,children:[u.currentVideo&&(0,n.jsx)("video",{ref:s,id:"bgvideo",className:"video",src:u.currentVideo,onCanPlay:()=>{d()},onEnded:()=>{c(e=>o(l({},e),{currentVideo:"",isPlaying:!1,isLoading:!1}))},muted:!0,loop:!1,playsInline:!0,preload:"auto"}),(0,n.jsx)("div",{className:u.currentVideo?u.isPlaying?"video-btn video-pause":"video-btn video-play":"video-btn loadvideo",onClick:()=>{u.currentVideo?u.isPlaying?s.current&&(s.current.pause(),c(e=>o(l({},e),{isPlaying:!1}))):d():p()},style:{display:r.length>0?"block":"none"}}),(0,n.jsx)("div",{className:"video-add",style:{display:u.isPlaying?"block":"none"},onClick:p}),(0,n.jsxs)("div",{className:"video-stu",style:{bottom:u.isPlaying?"-100px":"0px"},children:[!u.isPlaying&&u.currentVideo&&"已暂停 ...",u.isLoading&&"正在载入视频 ..."]})]})},a=e=>{let{onPlay:t,onStop:r}=e;return(0,n.jsx)("div",{})},u=["#FF5252","#FF4081","#E040FB","#7C4DFF","#536DFE","#448AFF","#40C4FF","#18FFFF","#64FFDA","#69F0AE","#B2FF59","#EEFF41"];var c=r(3630);let d=e=>{let{menu:t}=e;var r=(0,c.Zp)();return(0,n.jsx)("div",{className:"absolute h-auto right-0 top-1/2 transform -translate-y-1/2 z-10",children:(0,n.jsx)("ul",{children:null==t?void 0:t.map(e=>(0,n.jsx)("li",{className:"text-[#f57878] hover:text-cyan-300 text-right mr-2",children:(0,n.jsxs)("a",{style:{cursor:"pointer"},onClick:t=>((e,t)=>{if(e.preventDefault(),t){if(!t.startsWith("me")){if(t.startsWith("http"))return void window.open(t);r(t,{replace:!0})}}})(t,e.path),children:[(0,n.jsx)("div",{className:"relative text-[40px] [text-shadow:-1px_0_white,0_1px_white,1px_0_white,0_-1px_white]",children:e.name}),(0,n.jsx)("div",{className:"relative -mt-4",children:e.title})]})},e.name))})})};var p=r(8216);let f=()=>{let{audioRef:e,isPlaying:t,audioInfo:r,playAudio:l,stopAudio:o,getFrequencyData:c,getAverageFrequency:f}=(()=>{let[e,t]=(0,i.useState)(null),[r,n]=(0,i.useState)(null),[l,o]=(0,i.useState)(!1),[s,a]=(0,i.useState)(""),u=(0,i.useRef)(null),c=(0,i.useRef)(null),d=()=>{if(!r)return null;let e=new Uint8Array(r.frequencyBinCount);return r.getByteFrequencyData(e),e};return{audioRef:c,isPlaying:l,audioInfo:s,playAudio:(i,l)=>{if(!e){let e=new(window.AudioContext||window.webkitAudioContext),r=e.createAnalyser();r.fftSize=256,t(e),n(r)}(null==e?void 0:e.state)==="suspended"&&e.resume(),(t=>{if(!e||!r)return;u.current&&u.current.disconnect();let n=e.createMediaElementSource(t);n.connect(r),r.connect(e.destination),u.current=n})(i),i.play(),o(!0),l&&a("正在播放: ".concat(l))},stopAudio:()=>{c.current&&(c.current.pause(),c.current.currentTime=0),o(!1),a("")},getFrequencyData:d,getAverageFrequency:()=>{let e=d();if(!e)return 0;let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t/e.length}}})(),{getColorForElement:y}=((e,t,r)=>{let[n,l]=(0,i.useState)([]),o=(0,i.useRef)(0),s=(0,i.useRef)(0);return(0,i.useEffect)(()=>{if(!t){l([]),o.current&&cancelAnimationFrame(o.current);return}let n=()=>{setTimeout(()=>{t&&(s.current=(s.current+1)%e,l([s.current,(s.current+1)%e,(s.current+2)%e]),o.current=requestAnimationFrame(n))},Math.max(100,500-3*r))};return o.current=requestAnimationFrame(n),()=>{o.current&&cancelAnimationFrame(o.current)}},[t,r,e]),{getColorForElement:e=>{if(!n.includes(e))return"#333";let t=n.indexOf(e),r=(e+t)%u.length;return u[r]},activeElements:n}})(8,t,f()),[m,h]=(0,i.useState)([]);return(0,i.useEffect)(()=>{(async()=>{h(await p.s.get().menu)})()},[]),(0,n.jsxs)("div",{className:"App",children:[(0,n.jsx)(a,{onPlay:l,onStop:o,audioInfo:r}),(0,n.jsxs)("div",{className:"headertop filter-dot",children:[(0,n.jsx)(s,{movies:["https://video.cdn.queniuqe.com/store_trailers/256982456/movie480_vp9.webm?t=1703239286"]}),(0,n.jsx)(d,{menu:m})]}),(0,n.jsx)("audio",{ref:e,style:{display:"none"}})]})}}}]);
//# sourceMappingURL=824.bundle.js.map